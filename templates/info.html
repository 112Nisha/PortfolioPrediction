{% extends 'base.html' %}
{% block title %}Info - PortfolioPrediction{% endblock %}
{% block content %}
<div class="container my-4">
    <h1 class="mb-4">Portfolio Optimization and Analysis Information</h1>

    <section class="mb-5">
        <h2 class="h3">1. Core Concepts in Portfolio Optimization</h2>
        <p>Portfolio optimization is a mathematical approach to constructing an investment portfolio by selecting the proportion of various assets. The primary goal is to achieve the best possible balance between maximizing expected returns and minimizing investment risk, often based on historical data.</p>

        <h3 class="h4">Key Metrics:</h3>
        <ul>
            <li><strong>Expected Return (Mean):</strong> This represents the average historical return an investment portfolio is anticipated to generate over a given period. It's a measure of the potential profit from an investment.</li>
            <li><strong>Risk (Volatility/Variance):</strong> This quantifies the degree of variation of a trading price series over time, reflecting the uncertainty or magnitude of changes in an investment's value. A higher variance typically indicates higher risk.</li>
            <li><strong>Efficient Frontier:</strong> This is a fundamental concept in Modern Portfolio Theory (MPT). It is a curve that represents the set of "optimal" portfolios that offer the highest possible expected return for a given level of risk, or the lowest possible risk for a given expected return. Portfolios below the frontier are sub-optimal, and those above are unattainable.</li>
        </ul>
    </section>

    <section class="mb-5">
        <h2 class="h3">2. Return Estimation Methods</h2>
        <p>These methods estimate the expected future returns for assets.</p>

        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Formula</th>
                    <th>Variable Meaning</th>
                    <th>Significance</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Mean Historical Return</td>
                    <td>$$ \bar{R} = \frac{1}{N} \sum_{i=1}^{N} R_i $$</td>
                    <td>
                        \( R_i \): return in period i<br>
                        \( N \): total periods
                    </td>
                    <td>Simple average of past returns; assumes future returns mirror past performance.</td>
                </tr>
                <tr>
                    <td>Exponentially Weighted Mean (EWM)</td>
                    <td>$$ \bar{R}_{EWM} = \sum_{i=1}^{N} w_i R_i, \quad w_i = (1-\lambda)\lambda^{N-i} $$</td>
                    <td>
                        \( \lambda \): decay factor (0&lt;λ&lt;1)<br>
                        \( R_i \): historical returns
                    </td>
                    <td>Gives higher weight to recent data, adapting to current market trends.</td>
                </tr>
                <tr>
                    <td>CAPM Expected Return</td>
                    <td>$$ E[R_i] = R_f + \beta_i (E[R_m] - R_f) $$</td>
                    <td>
                        \( R_f \): risk-free rate<br>
                        \( \beta_i \): asset’s market sensitivity<br>
                        \( E[R_m] \): expected market return
                    </td>
                    <td>Theoretical model explicitly linking systematic risk and expected return.</td>
                </tr>
            </tbody>
        </table>
    </section>

    <section class="mb-5">
        <h2 class="h3">3. Covariance Estimation Methods</h2>
        <p>Covariance indicates how two assets move relative to each other, impacting diversification and overall portfolio risk.</p>

        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Formula</th>
                    <th>Variable Meaning</th>
                    <th>Significance</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Sample Covariance</td>
                    <td>$$ \text{Cov}(X,Y) = \frac{1}{N-1} \sum_{i=1}^{N} (X_i - \bar{X})(Y_i - \bar{Y}) $$</td>
                    <td>
                        \( X_i, Y_i \): asset returns<br>
                        \( \bar{X}, \bar{Y} \): mean returns
                    </td>
                    <td>Direct estimate of co-movement from historical data; noisy for small datasets.</td>
                </tr>
                <tr>
                    <td>Exponentially Weighted Covariance</td>
                    <td>$$ \text{Cov}_{EWM} = \sum_{i} w_i (X_i - \bar{X})(Y_i - \bar{Y}) $$</td>
                    <td>
                        \( w_i \): exponentially decaying weights<br>
                        \( \bar{X}, \bar{Y} \): weighted means
                    </td>
                    <td>Adapts to changing market conditions by emphasizing recent data.</td>
                </tr>
                <tr>
                    <td>Semicovariance</td>
                    <td>$$ \text{SemiCov} = \frac{1}{N} \sum_{i=1}^{N} \min(0, R_i - \bar{R})^2 $$</td>
                    <td>
                        \( R_i \): individual returns<br>
                        \( \bar{R} \): mean return
                    </td>
                    <td>Focuses on downside movements—useful for investors sensitive to losses.</td>
                </tr>
            </tbody>
        </table>
    </section>

    <section class="mb-5">
        <h2 class="h3">4. Risk Metrics</h2>
        <p>Risk metrics assess the volatility, tail-risk, and drawdown potential of a portfolio.</p>

        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Formula</th>
                    <th>Variable Meaning</th>
                    <th>Significance</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Variance</td>
                    <td>$$ \sigma^2 = \frac{1}{N-1} \sum_{i=1}^{N} (R_i - \bar{R})^2 $$</td>
                    <td>\( R_i \): returns, \( \bar{R} \): mean return</td>
                    <td>Classical measure of total risk (volatility).</td>
                </tr>
                <tr>
                    <td>Value at Risk (VaR)</td>
                    <td>$$ \text{VaR}_\alpha = -F_R^{-1}(\alpha) $$</td>
                    <td>\( F_R^{-1} \): inverse CDF of returns, \( \alpha \): confidence level</td>
                    <td>Maximum expected loss over a time period at confidence level α.</td>
                </tr>
                <tr>
                    <td>Conditional VaR (CVaR)</td>
                    <td>$$ \text{CVaR}_\alpha = E[R \mid R \leq \text{VaR}_\alpha] $$</td>
                    <td>\( R \): returns, \( \alpha \): confidence level</td>
                    <td>Expected loss beyond VaR; better captures extreme downside risk.</td>
                </tr>
                <tr>
                    <td>Sharpe Ratio</td>
                    <td>$$ S = \frac{E[R_p - R_f]}{\sigma_p} $$</td>
                    <td>\( R_p \): portfolio return, \( R_f \): risk-free rate, \( \sigma_p \): portfolio volatility</td>
                    <td>Measures risk-adjusted performance; higher is better.</td>
                </tr>
                <tr>
                    <td>Max Drawdown</td>
                    <td>$$ \text{MDD} = \max_{t}( \frac{P_{peak} - P_t}{P_{peak}} ) $$</td>
                    <td>\( P_t \): portfolio value at time t, \( P_{peak} \): max historical value</td>
                    <td>Shows largest drop from a peak to a trough—key for downside assessment.</td>
                </tr>
            </tbody>
        </table>
    </section>

    <section class="mb-5">
        <h2 class="h3">5. Optimization Goals</h2>
        <p>Our application supports two main approaches to portfolio optimization:</p>
        <ul>
            <li><strong>Mean-Variance Optimization:</strong>
                <p>This traditional approach, using <code>/mean_variance</code> endpoint, allows you to input your desired portfolio (stocks and weights). The system then calculates various metrics for your portfolio (Variance, VaR, CVaR, Sharpe Ratio, Max Drawdown). It also finds optimized portfolios based on two criteria:</p>
                <ul>
                    <li><strong>Return-Optimized for User's Risk:</strong> For the same risk level as your current portfolio (e.g., your portfolio's variance), it finds a new portfolio that achieves the maximum possible return.</li>
                    <li><strong>Risk-Optimized for User's Return:</strong> For the same expected return as your current portfolio, it finds a new portfolio that minimizes a specific risk metric (e.g., minimizes variance, VaR, CVaR, etc.).</li>
                </ul>
                <p>It generates efficient frontiers (plots showing the trade-off between risk and return) for Variance, VaR, CVaR, Sharpe Ratio, and Max Drawdown.</p>
            </li>
            <li><strong>Risk Optimization (Maximize Return for Target Risk):</strong>
                <p>Accessed via the <code>/risk_opt</code> endpoint, this feature allows you to specify a target level for a chosen risk metric (e.g., "I want a maximum VaR of 0.02"). The system then optimizes a portfolio to achieve the highest possible return while staying within your specified risk tolerance.</p>
            </li>
        </ul>
    </section>

    <section class="mb-5">
        <h2 class="h3">6. Backtesting and Time Series Analysis</h2>
        <p>To evaluate the robustness of optimization strategies, our platform incorporates backtesting:</p>
        <ul>
            <li><strong>Train/Test Split:</strong> The available historical data is split into "train" and "test" periods (e.g., 36 months for training, 3 months for testing). The optimization is performed exclusively on the "train" data to derive optimal weights.</li>
            <li><strong>Out-of-Sample Evaluation:</strong> The optimized weights are then applied to the "test" (out-of-sample) data to simulate how the portfolio would have performed in a period not seen during optimization. This provides a more realistic assessment of the strategy's effectiveness.</li>
            <li><strong>Backtrader Integration:</strong> We utilize the <code>Backtrader</code> library to run these simulations. This generates cumulative return plots for various portfolio types (user, variance-optimized, VaR-optimized, etc.) over different test horizons (e.g., 1-month, 2-month, 3-month backtests).</li>
        </ul>
    </section>

    <section class="mb-5">
        <h2 class="h3">7. Backend Technologies</h2>
        <p>The application is built using a combination of powerful Python libraries:</p>
        <ul>
            <li><strong>Flask:</strong> A lightweight web framework used to handle web requests, routes, and render HTML templates.</li>
            <li><strong>PyPortfolioOpt (`pypfopt`):</strong> A comprehensive library for portfolio optimization, providing efficient implementations of Mean-Variance, CVaR, and other optimization techniques, along with various return and risk model estimators.</li>
            <li><strong>Backtrader:</strong> A powerful and flexible Python framework for backtesting trading strategies, allowing realistic simulations of portfolio performance over historical data.</li>
            <li><strong>Plotly:</strong> An interactive graphing library used to generate the efficient frontier plots and backtesting results, allowing users to hover over points for detailed information.</li>
            <li><strong>Pandas & NumPy:</strong> Fundamental libraries for data manipulation and numerical operations, heavily used for handling financial time series data and calculations.</li>
        </ul>
    </section>

    <section class="mb-5">
        <h2 class="h3">8. Data Source</h2>
        <p>The historical stock price data used for analysis is sourced from CSV files stored locally in the <code>./data</code> directory. Each file typically contains daily Open, High, Low, Close, and Volume data for a specific stock. The application automatically reads these files to provide available stock options and compute historical metrics.</p>
    </section>

    <p class="mt-5 text-muted text-center">This information helps explain the methodologies and tools behind the PortfolioPrediction application.</p>
</div>

<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { fontCache: 'global' }
};
</script>
<script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>


{% endblock %}